{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{1137:function(t,e,n){\"use strict\";n.r(e);var i=n(2235),r=n(1750);for(var a in r)[\"default\"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(a);n(2157);var s=n(30),o=Object(s.a)(r.default,i.a,i.b,!1,null,null,null);e.default=o.exports},1183:function(t,e,n){\"use strict\";n.r(e);var i=n(1184),r=n.n(i);for(var a in i)[\"default\"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e.default=r.a},1184:function(t,e,n){\"use strict\";e.__esModule=!0,e.default={name:\"list-construction\",data:function(){return{}},props:{title:String}}},1186:function(t,e,n){\"use strict\";n.r(e);var i=n(1188),r=n(1183);for(var a in r)[\"default\"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(a);var s=n(30),o=Object(s.a)(r.default,i.a,i.b,!1,null,null,null);e.default=o.exports},1188:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return i})),n.d(e,\"b\",(function(){return r}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{staticClass:\"home-main list-construction-model\"},[n(\"div\",{staticClass:\"content-title\"},[n(\"span\",[t._v(t._s(t.title))]),t._v(\" \"),t._t(\"operation\")],2),t._v(\" \"),n(\"div\",{staticClass:\"conditions-box\"},[t._t(\"conditions\")],2),t._v(\" \"),n(\"div\",{staticClass:\"list-box\"},[t._t(\"content\")],2)])},r=[]},1189:function(t,e,n){\"use strict\";n.r(e);var i=n(1190),r=n.n(i);for(var a in i)[\"default\"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e.default=r.a},1190:function(t,e,n){\"use strict\";e.__esModule=!0,e.default={name:\"no-data\",props:{msg:String,height:Number}}},1191:function(t,e,n){\"use strict\";n.r(e);var i=n(1192),r=n.n(i);for(var a in i)[\"default\"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e.default=r.a},1192:function(t,e,n){\"use strict\";e.__esModule=!0,e.default={name:\"spin\",data:function(){return{}},props:{isSpin:{type:Boolean,default:!0},isLeft:{type:Boolean,default:!0}}}},1193:function(t,e,n){\"use strict\";n.r(e);var i=n(1209),r=n(1189);for(var a in r)[\"default\"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(a);n(1208);var s=n(30),o=Object(s.a)(r.default,i.a,i.b,!1,null,null,null);e.default=o.exports},1195:function(t,e,n){},1196:function(t,e,n){\"use strict\";n.r(e);var i=n(1211),r=n(1191);for(var a in r)[\"default\"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(a);n(1210);var s=n(30),o=Object(s.a)(r.default,i.a,i.b,!1,null,null,null);e.default=o.exports},1198:function(t,e,n){},1207:function(t,e,n){t.exports=n.p+\"images/errorTip.png?a7b20f0ca8727f22f405c2a34d1363a0\"},1208:function(t,e,n){\"use strict\";n(1195)},1209:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return i})),n.d(e,\"b\",(function(){return r}));var i=function(){var t=this.$createElement,e=this._self._c||t;return e(\"div\",{staticClass:\"no-data-model\",style:{height:this.height+\"px\"}},[e(\"div\",{staticClass:\"no-data-box\"},[this._m(0),this._v(\" \"),e(\"div\",{staticClass:\"text\"},[this._v(this._s(this.msg||this.$t(\"No data\")))])])])},r=[function(){var t=this.$createElement,e=this._self._c||t;return e(\"div\",{staticClass:\"img\"},[e(\"img\",{attrs:{src:n(1207),alt:\"\"}})])}]},1210:function(t,e,n){\"use strict\";n(1198)},1211:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return i})),n.d(e,\"b\",(function(){return r}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isSpin?n(\"div\",{class:t.isLeft?\"spin-sp2\":\"spin-sp1\",attrs:{id:\"spin-model\"}},[n(\"div\",{staticClass:\"svg-box\"},[n(\"svg\",{staticClass:\"lds-gears\",staticStyle:{background:\"none\"},attrs:{width:\"54px\",height:\"54px\",xmlns:\"http://www.w3.org/2000/svg\",\"xmlns:xlink\":\"http://www.w3.org/1999/xlink\",viewBox:\"0 0 100 100\",preserveAspectRatio:\"xMidYMid\"}},[n(\"g\",{attrs:{transform:\"translate(50 50)\"}},[n(\"g\",{attrs:{transform:\"translate(-19 -19) scale(0.6)\"}},[n(\"g\",{attrs:{transform:\"rotate(107.866)\"}},[n(\"animateTransform\",{attrs:{attributeName:\"transform\",type:\"rotate\",values:\"0;360\",keyTimes:\"0;1\",dur:\"1s\",begin:\"0s\",repeatCount:\"indefinite\"}}),n(\"path\",{attrs:{d:\"M37.3496987939662 -7 L47.3496987939662 -7 L47.3496987939662 7 L37.3496987939662 7 A38 38 0 0 1 31.359972760794346 21.46047782418268 L31.359972760794346 21.46047782418268 L38.431040572659825 28.531545636048154 L28.531545636048154 38.431040572659825 L21.46047782418268 31.359972760794346 A38 38 0 0 1 7.0000000000000036 37.3496987939662 L7.0000000000000036 37.3496987939662 L7.000000000000004 47.3496987939662 L-6.999999999999999 47.3496987939662 L-7 37.3496987939662 A38 38 0 0 1 -21.46047782418268 31.35997276079435 L-21.46047782418268 31.35997276079435 L-28.531545636048154 38.431040572659825 L-38.43104057265982 28.531545636048158 L-31.359972760794346 21.460477824182682 A38 38 0 0 1 -37.3496987939662 7.000000000000007 L-37.3496987939662 7.000000000000007 L-47.3496987939662 7.000000000000008 L-47.3496987939662 -6.9999999999999964 L-37.3496987939662 -6.999999999999997 A38 38 0 0 1 -31.35997276079435 -21.460477824182675 L-31.35997276079435 -21.460477824182675 L-38.431040572659825 -28.531545636048147 L-28.53154563604818 -38.4310405726598 L-21.4604778241827 -31.35997276079433 A38 38 0 0 1 -6.999999999999992 -37.3496987939662 L-6.999999999999992 -37.3496987939662 L-6.999999999999994 -47.3496987939662 L6.999999999999977 -47.3496987939662 L6.999999999999979 -37.3496987939662 A38 38 0 0 1 21.460477824182686 -31.359972760794342 L21.460477824182686 -31.359972760794342 L28.531545636048158 -38.43104057265982 L38.4310405726598 -28.53154563604818 L31.35997276079433 -21.4604778241827 A38 38 0 0 1 37.3496987939662 -6.999999999999995 M0 -23A23 23 0 1 0 0 23 A23 23 0 1 0 0 -23\",fill:\"#0097e0\"}})],1)]),t._v(\" \"),n(\"g\",{attrs:{transform:\"translate(19 19) scale(0.6)\"}},[n(\"g\",{attrs:{transform:\"rotate(229.634)\"}},[n(\"animateTransform\",{attrs:{attributeName:\"transform\",type:\"rotate\",values:\"360;0\",keyTimes:\"0;1\",dur:\"1s\",begin:\"-0.0625s\",repeatCount:\"indefinite\"}}),n(\"path\",{attrs:{d:\"M37.3496987939662 -7 L47.3496987939662 -7 L47.3496987939662 7 L37.3496987939662 7 A38 38 0 0 1 31.359972760794346 21.46047782418268 L31.359972760794346 21.46047782418268 L38.431040572659825 28.531545636048154 L28.531545636048154 38.431040572659825 L21.46047782418268 31.359972760794346 A38 38 0 0 1 7.0000000000000036 37.3496987939662 L7.0000000000000036 37.3496987939662 L7.000000000000004 47.3496987939662 L-6.999999999999999 47.3496987939662 L-7 37.3496987939662 A38 38 0 0 1 -21.46047782418268 31.35997276079435 L-21.46047782418268 31.35997276079435 L-28.531545636048154 38.431040572659825 L-38.43104057265982 28.531545636048158 L-31.359972760794346 21.460477824182682 A38 38 0 0 1 -37.3496987939662 7.000000000000007 L-37.3496987939662 7.000000000000007 L-47.3496987939662 7.000000000000008 L-47.3496987939662 -6.9999999999999964 L-37.3496987939662 -6.999999999999997 A38 38 0 0 1 -31.35997276079435 -21.460477824182675 L-31.35997276079435 -21.460477824182675 L-38.431040572659825 -28.531545636048147 L-28.53154563604818 -38.4310405726598 L-21.4604778241827 -31.35997276079433 A38 38 0 0 1 -6.999999999999992 -37.3496987939662 L-6.999999999999992 -37.3496987939662 L-6.999999999999994 -47.3496987939662 L6.999999999999977 -47.3496987939662 L6.999999999999979 -37.3496987939662 A38 38 0 0 1 21.460477824182686 -31.359972760794342 L21.460477824182686 -31.359972760794342 L28.531545636048158 -38.43104057265982 L38.4310405726598 -28.53154563604818 L31.35997276079433 -21.4604778241827 A38 38 0 0 1 37.3496987939662 -6.999999999999995 M0 -23A23 23 0 1 0 0 23 A23 23 0 1 0 0 -23\",fill:\"#7f8b95\"}})],1)])])]),t._v(\" \"),n(\"span\",{staticClass:\"sp1\"},[t._v(t._s(t.$t(\"Loading...\")))])])]):t._e()},r=[]},1750:function(t,e,n){\"use strict\";n.r(e);var i=n(1751),r=n.n(i);for(var a in i)[\"default\"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e.default=r.a},1751:function(t,e,n){\"use strict\";e.__esModule=!0;var i=d(n(94)),r=n(650),a=d(n(2155)),s=n(371),o=d(n(1196)),u=d(n(1193)),c=n(743),l=d(n(1186));function d(t){return t&&t.__esModule?t:{default:t}}e.default={name:\"tree-view-index-index\",data:function(){return{limit:25,isLoading:!0,tasksType:c.tasksType,tasksState:c.tasksState,treeData:{},isNodata:!1}},props:{},methods:Object.assign({},(0,r.mapActions)(\"dag\",[\"getViewTree\"]),{_close:function(){this.$router.go(-1)},_getViewTree:function(){var t=this;this.isLoading=!0,a.default.reset(),this.getViewTree({processId:this.$route.params.id,limit:this.limit}).then((function(e){var n=i.default.cloneDeep(e);if(t.treeData=n,!t.treeData.children)return t.isLoading=!1,void(t.isNodata=!0);!function t(e){e.length&&i.default.map(e,(function(e){e.uuid=\"\"+(0,s.uuid)(\"uuid_\")+((0,s.uuid)()+(0,s.uuid)()),e.children.length&&t(e.children)}))}(n.children),a.default.init({data:i.default.cloneDeep(n),limit:t.limit,selfTree:t}).then((function(){setTimeout((function(){}),100)}))})).catch((function(e){t.isLoading=!1,e.data||(t.isNodata=!0)}))},_rtTasksDag:function(){var t=this.$route.query.subProcessIds.split(\",\"),e=t.slice(0,t.length-1),n=t[t.length-1],i={};n!==t[0]&&(i={subProcessIds:e.join(\",\")}),this.$router.push({path:\"/projects/definition/tree/\"+n,query:i})},_subProcessHandle:function(t){var e=[],n=this.$route.query.subProcessIds;if(n){var i=n.split(\",\");i.push(this.$route.params.id),e=i}else e.push(this.$route.params.id);this.$router.push({path:\"/projects/definition/tree/\"+t,query:{subProcessIds:e.join(\",\")}})},_onChangeSelect:function(t){this.limit=t,this._getViewTree()}}),watch:{\"$route.params.id\":function(){this._getViewTree()}},created:function(){this._getViewTree()},mounted:function(){},components:{mSpin:o.default,mListConstruction:l.default,mNoData:u.default}}},1991:function(t,e,n){},2155:function(t,e,n){\"use strict\";(function(t){e.__esModule=!0;var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1493)),r=n(2156),a=n(743);var s=void 0,o=function(){s=this,this.selfTree={},this.tree=function(){},this.config={barHeight:26,axisHeight:40,squareSize:10,squarePading:4,taskNum:25,nodesMax:0},this.config.margin={top:this.config.barHeight/2+this.config.axisHeight,right:0,bottom:0,left:this.config.barHeight/2},this.config.margin.width=960-this.config.margin.left-this.config.margin.right,this.config.barWidth=parseInt(.9*this.config.margin.width)};o.prototype.init=function(t){var e=this,n=t.data,a=t.limit,s=t.selfTree;return new Promise((function(t,o){e.selfTree=s,e.config.taskNum=a,e.duration=400,e.i=0,e.tree=i.layout.tree().nodeSize([0,46]);var u=e.tree.nodes(n);e.diagonal=i.svg.diagonal().projection((function(t){return[t.y,t.x]})),e.svg=i.select(\"svg\").append(\"g\").attr(\"class\",\"level\").attr(\"transform\",\"translate(\"+e.config.margin.left+\",\"+e.config.margin.top+\")\"),n.x0=0,n.y0=0,e.squareNum=u[1===u.length?0:1].instances.length,e.config.nodesMax=(0,r.rtCountMethod)(n.children),e.treeUpdate(e.root=n).then((function(){e.treeTooltip(),s.isLoading=!1,t()}))}))},o.prototype.nodesClass=function(t){var e=\"node\";return void 0===t.children&&void 0===t._children?e+=\" leaf\":(e+=\" parent\",void 0===t.children?e+=\" collapsed\":e+=\" expanded\"),e},o.prototype.treeTooltip=function(){t(\"rect.state\").tooltip({html:!0,container:\"body\"}),t(\"circle.task\").tooltip({html:!0,container:\"body\"})},o.prototype.treeToggles=function(t){s.removeTooltip(),i.selectAll(\"[task_id='\"+t.uuid+\"']\").each((function(e){t!==e&&e.children&&(e._children=e.children,e.children=null,s.treeUpdate(e))})),t._children?(t.children=t._children,t._children=null):(t._children=t.children,t.children=null),s.treeUpdate(t),s.treeTooltip()},o.prototype.treeUpdate=function(t){var e=this;return new Promise((function(n,s){var o=e.tree.nodes(e.root),u=Math.max(500,o.length*e.config.barHeight+e.config.margin.top+e.config.margin.bottom),c=70*e.config.nodesMax+e.squareNum*(e.config.squareSize+e.config.squarePading)+e.config.margin.left+e.config.margin.right+50;i.select(\"svg\").transition().duration(e.duration).attr(\"height\",u).attr(\"width\",c),o.forEach((function(t,n){t.x=n*e.config.barHeight}));var l=e.svg.selectAll(\"g.node\").data(o,(function(t){return t.id||(t.id=++e.i)})),d=l.enter().append(\"g\").attr(\"class\",e.nodesClass).attr(\"transform\",(function(){return\"translate(\"+t.y0+\",\"+t.x0+\")\"})).style(\"opacity\",1e-6);d.append(\"circle\").attr(\"r\",e.config.barHeight/3).attr(\"class\",\"task\").attr(\"data-toggle\",\"tooltip\").attr(\"title\",(function(t){return t.type?t.type:\"\"})).attr(\"height\",e.config.barHeight).attr(\"width\",(function(t){return e.config.barWidth-t.y})).style(\"fill\",(function(t){return t.type?a.tasksType[t.type].color:\"#fff\"})).attr(\"task_id\",(function(t){return t.name})).on(\"click\",e.treeToggles),d.append(\"text\").attr(\"dy\",3.5).attr(\"dx\",e.config.barHeight/2).text((function(t){return t.name})),d.append(\"g\").attr(\"class\",\"stateboxes\").attr(\"transform\",(function(t,n){return\"translate(\"+(60*e.config.nodesMax-t.y)+\",0)\"})).selectAll(\"rect\").data((function(t){return t.instances})).enter().append(\"rect\").on(\"click\",(function(t){e.removeTooltip(),\"SUB_PROCESS\"===t.type&&e.selfTree._subProcessHandle(t.subflowId)})).attr(\"class\",\"state\").style(\"fill\",(function(t){return t.state&&a.tasksState[t.state].color||\"#ffffff\"})).attr(\"data-toggle\",\"tooltip\").attr(\"rx\",(function(t){return t.type?0:12})).attr(\"ry\",(function(t){return t.type?0:12})).style(\"shape-rendering\",(function(t){return t.type?\"crispEdges\":\"auto\"})).attr(\"title\",(function(t){return(0,r.rtInstancesTooltip)(t)})).attr(\"x\",(function(t,n){return n*(e.config.squareSize+e.config.squarePading)})).attr(\"y\",-e.config.squareSize/2).attr(\"width\",10).attr(\"height\",10).on(\"mouseover\",(function(){i.select(e).transition()})).on(\"mouseout\",(function(){i.select(e).transition()})),d.transition().duration(e.duration).attr(\"transform\",(function(t){return\"translate(\"+t.y+\",\"+t.x+\")\"})).style(\"opacity\",1),l.transition().duration(e.duration).attr(\"class\",e.nodesClass).attr(\"transform\",(function(t){return\"translate(\"+t.y+\",\"+t.x+\")\"})).style(\"opacity\",1),l.exit().transition().duration(e.duration).attr(\"transform\",(function(e){return\"translate(\"+t.y+\",\"+t.x+\")\"})).style(\"opacity\",1e-6).remove();var f=e.svg.selectAll(\"path.link\").data(e.tree.links(o),(function(t){return t.target.id}));f.enter().insert(\"path\",\"g\").attr(\"class\",\"link\").attr(\"d\",(function(n){var i={x:t.x0,y:t.y0};return e.diagonal({source:i,target:i})})).transition().duration(e.duration).attr(\"d\",e.diagonal),f.transition().duration(e.duration).attr(\"d\",e.diagonal),f.exit().transition().duration(e.duration).attr(\"d\",(function(n){var i={x:t.x,y:t.y};return e.diagonal({source:i,target:i})})).remove(),o.forEach((function(t){t.x0=t.x,t.y0=t.y})),n()}))},o.prototype.reset=function(){t(\".d3-tree .tree\").html(\"\")},o.prototype.removeTooltip=function(){t(\"body\").find(\".tooltip.fade.top.in\").remove()},e.default=new o}).call(this,n(55))},2156:function(t,e,n){\"use strict\";e.__esModule=!0,e.rtCountMethod=e.rtInstancesTooltip=void 0;var i=n(653),r=n(743);e.rtInstancesTooltip=function(t){var e='<div style=\"text-align: left;word-break:break-all\">';return e+=\"id : \"+t.id+\"</br>\",e+=\"host : \"+t.host+\"</br>\",e+=\"name : \"+t.name+\"</br>\",e+=\"state : \"+(t.state?r.tasksState[t.state].desc:\"-\")+\"（\"+t.state+\"）</br>\",t.type&&(e+=\"type : \"+t.type+\"</br>\"),e+=\"startTime : \"+(t.startTime?(0,i.formatDate)(t.startTime):\"-\")+\"</br>\",e+=\"endTime : \"+(t.endTime?(0,i.formatDate)(t.endTime):\"-\")+\"</br>\",e+=\"duration : \"+t.duration+\"</br>\",e+=\"</div>\"},e.rtCountMethod=function(t){var e=[];!function t(n,i){var r=!1;n.forEach((function(n){n.children&&n.children.length>0&&(r||(r=!0,i+=\"*\",e.push(i)),t(n.children,i))}))}(t,\"*\");var n=6;return e.forEach((function(t){t.length>n&&(n=t.length)})),n}},2157:function(t,e,n){\"use strict\";n(1991)},2235:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return i})),n.d(e,\"b\",(function(){return r}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"m-list-construction\",{attrs:{title:t.$t(\"TreeView\")}},[n(\"template\",{slot:\"operation\"},[n(\"span\",{staticStyle:{float:\"right\",\"padding-right\":\"50px\"}},[n(\"em\",{staticClass:\"el-icon-back\",staticStyle:{\"font-size\":\"20px\"},attrs:{\"data-container\":\"body\",\"data-toggle\":\"tooltip\",title:t.$t(\"Return\")},on:{click:function(e){return t._close()}}})])]),t._v(\" \"),n(\"template\",{slot:\"conditions\"}),t._v(\" \"),n(\"template\",{slot:\"content\"},[n(\"div\",{staticClass:\"tree-view-index-model\"},[n(\"div\",{staticClass:\"tree-limit-select\"},[n(\"el-select\",{staticStyle:{width:\"70px\"},attrs:{size:\"small\"},on:{change:t._onChangeSelect},model:{value:t.limit,callback:function(e){t.limit=e},expression:\"limit\"}},t._l([{value:25},{value:50},{value:75},{value:100}],(function(t){return n(\"el-option\",{key:t.value,attrs:{value:t.value,label:t.value}})})),1),t._v(\" \"),t.$route.query.subProcessIds?n(\"el-button\",{attrs:{type:\"primary\",size:\"small\",icon:\"el-icon-d-arrow-left\"},on:{click:t._rtTasksDag}},[t._v(\"\\n          \"+t._s(t.$t(\"Return_1\"))+\"\\n        \")]):t._e()],1),t._v(\" \"),n(\"div\",{staticClass:\"tasks-color\"},[n(\"div\",{staticClass:\"toolbar-color-sp\"},[n(\"a\",{attrs:{href:\"javascript:\"}},[n(\"span\",[t._v(\"Node Type\")])]),t._v(\" \"),t._l(t.tasksType,(function(e,i){return n(\"a\",{key:i,attrs:{href:\"javascript:\"}},[n(\"em\",{staticClass:\"el-icon-user-solid\",style:{color:e.color}}),t._v(\" \"),n(\"span\",[t._v(t._s(i))])])}))],2),t._v(\" \"),n(\"div\",{staticClass:\"state-tasks-color-sp\"},[n(\"a\",{attrs:{href:\"javascript:\"}},[n(\"span\",[t._v(t._s(t.$t(\"Task Status\")))])]),t._v(\" \"),t._l(t.tasksState,(function(e){return n(\"a\",{key:e.id,attrs:{href:\"javascript:\"}},[n(\"em\",{staticClass:\"ri-checkbox-blank-fill\",style:{color:e.color}}),t._v(\" \"),n(\"span\",[t._v(t._s(e.desc))])])}))],2)]),t._v(\" \"),n(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:!t.isNodata,expression:\"!isNodata\"}],staticClass:\"tree-model\"},[n(\"div\",{staticClass:\"d3-tree\"},[n(\"svg\",{staticClass:\"tree\",attrs:{width:\"100%\"}})])]),t._v(\" \"),t.isNodata?n(\"m-no-data\"):t._e()],1),t._v(\" \"),n(\"m-spin\",{attrs:{\"is-spin\":t.isLoading}})],1)],2)},r=[]}}]);","extractedComments":[]}