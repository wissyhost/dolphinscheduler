(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{1128:function(t,e,n){"use strict";n.r(e);var i=n(1937),o=n(1453);for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);var s=n(30),r=Object(s.a)(o.default,i.a,i.b,!1,null,null,null);e.default=r.exports},1183:function(t,e,n){"use strict";n.r(e);var i=n(1184),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e.default=o.a},1184:function(t,e,n){"use strict";e.__esModule=!0,e.default={name:"list-construction",data:function(){return{}},props:{title:String}}},1187:function(t,e,n){"use strict";n.r(e);var i=n(1189),o=n(1183);for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);var s=n(30),r=Object(s.a)(o.default,i.a,i.b,!1,null,null,null);e.default=r.exports},1189:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home-main list-construction-model"},[n("div",{staticClass:"content-title"},[n("span",[t._v(t._s(t.title))]),t._v(" "),t._t("operation")],2),t._v(" "),n("div",{staticClass:"conditions-box"},[t._t("conditions")],2),t._v(" "),n("div",{staticClass:"list-box"},[t._t("content")],2)])},o=[]},1202:function(t,e,n){"use strict";n.r(e);var i=n(1203),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e.default=o.a},1203:function(t,e,n){"use strict";e.__esModule=!0;var i,o=n(83),a=(i=o)&&i.__esModule?i:{default:i};e.default={name:"popup",data:function(){return{spinnerLoading:!1,apDisabled:!1}},props:{okText:{type:String,default:""+a.default.$t("Confirm")},disabled:{type:Boolean,default:!1},asynLoading:{type:Boolean,default:!1}},methods:{close:function(){this.$emit("close")},ok:function(){var t=this;this.asynLoading?(this.spinnerLoading=!0,this.$emit("ok",(function(){t.spinnerLoading=!1}))):this.$emit("ok")}},components:{}}},1206:function(t,e,n){"use strict";e.__esModule=!0;var i,o=n(94),a=(i=o)&&i.__esModule?i:{default:i},s=n(1219);e.default={watch:{searchParams:{deep:!0,handler:function(){(0,s.setUrlParams)(this.searchParams),this._debounceGET()}}},created:function(){a.default.isEmpty(this.$route.query)||(this.searchParams=a.default.assign(this.searchParams,this.$route.query))},mounted:function(){this._debounceGET()},methods:{_debounceGET:a.default.debounce((function(t){this._getList(t)}),100,{leading:!1,trailing:!0})}}},1213:function(t,e,n){},1223:function(t,e,n){"use strict";n.r(e);var i=n(1228),o=n(1202);for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n(1224);var s=n(30),r=Object(s.a)(o.default,i.a,i.b,!1,null,null,null);e.default=r.exports},1224:function(t,e,n){"use strict";n(1213)},1228:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"popup-model"},[n("div",{staticClass:"content-p"},[t._t("content")],2),t._v(" "),n("div",{staticClass:"bottom-p"},[n("el-button",{attrs:{type:"text",size:"mini",round:"",disabled:t.disabled},on:{click:function(e){return t.close()}}},[t._v(" "+t._s(t.$t("Cancel"))+" ")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini",round:"",loading:t.spinnerLoading,disabled:t.disabled||t.apDisabled},on:{click:function(e){return t.ok()}}},[t._v(t._s(t.spinnerLoading?"Loading...":t.okText)+" ")])],1)])},o=[]},1453:function(t,e,n){"use strict";n.r(e);var i=n(1454),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e.default=o.a},1454:function(t,e,n){"use strict";e.__esModule=!0;var i=f(n(94)),o=n(650),a=f(n(1898)),s=f(n(1197)),r=f(n(1899)),u=f(n(1194)),c=f(n(1206)),l=f(n(1220)),d=f(n(1187));function f(t){return t&&t.__esModule?t:{default:t}}e.default={name:"token-index",data:function(){return{total:null,isLoading:!1,tokenList:[],searchParams:{pageSize:10,pageNo:1,searchVal:""},isLeft:!0,createTokenDialog:!1}},mixins:[c.default],props:{},methods:Object.assign({},(0,o.mapActions)("user",["getTokenListP"]),{_onConditions:function(t){this.searchParams=i.default.assign(this.searchParams,t),this.searchParams.pageNo=1},_page:function(t){this.searchParams.pageNo=t},_pageSize:function(t){this.searchParams.pageSize=t},_onEdit:function(t){this._create(t)},_onUpdate:function(){this._debounceGET()},_create:function(t){this.item=t,this.createTokenDialog=!0},onUpdate:function(){this._debounceGET("false"),this.createTokenDialog=!1},close:function(){this.createTokenDialog=!1},_getList:function(t){var e=this;0===sessionStorage.getItem("isLeft")?this.isLeft=!1:this.isLeft=!0,this.isLoading=!t,this.getTokenListP(this.searchParams).then((function(t){e.searchParams.pageNo>1&&0===t.totalList.length?e.searchParams.pageNo=e.searchParams.pageNo-1:(e.tokenList=[],e.tokenList=t.totalList,e.total=t.total,e.isLoading=!1)})).catch((function(t){e.isLoading=!1}))}}),watch:{$route:function(t){this.searchParams.pageNo=i.default.isEmpty(t.query)?1:t.query.pageNo}},created:function(){},mounted:function(){},beforeDestroy:function(){sessionStorage.setItem("isLeft",1)},components:{mList:a.default,mListConstruction:d.default,mConditions:l.default,mSpin:s.default,mNoData:u.default,mCreateToken:r.default}}},1455:function(t,e,n){"use strict";n.r(e);var i=n(1456),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e.default=o.a},1456:function(t,e,n){"use strict";e.__esModule=!0;var i=n(650);e.default={name:"token-list",data:function(){return{list:[]}},props:{tokenList:Array,pageNo:Number,pageSize:Number},methods:Object.assign({},(0,i.mapActions)("user",["deleteToken"]),{_delete:function(t,e){var n=this;this.deleteToken({id:t.id}).then((function(t){n.$emit("on-update"),n.$message.success(t.msg)})).catch((function(t){n.$message.error(t.msg||"")}))},_edit:function(t){this.$emit("on-edit",t)}}),watch:{tokenList:function(t){var e=this;this.list=[],setTimeout((function(){e.list=t}))}},created:function(){this.list=this.tokenList},mounted:function(){},components:{}}},1457:function(t,e,n){"use strict";n.r(e);var i=n(1458),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e.default=o.a},1458:function(t,e,n){"use strict";e.__esModule=!0;var i=l(n(94)),o=l(n(744)),a=l(n(83)),s=l(n(196)),r=l(n(745)),u=l(n(1223)),c=l(n(370));function l(t){return t&&t.__esModule?t:{default:t}}e.default={name:"create-token",data:function(){return{store:s.default,expireTime:(0,o.default)().format("YYYY-MM-DD 23:59:59"),userId:null,disabledDate:function(t){return t.getTime()-new Date((new Date).getTime()-864e5)<0},token:"",userIdList:[],tokenLoading:!1,auth:!r.default.getAuth(),pickerOptions:{disabledDate:function(t){return t.getTime()<Date.now()-864e5}}}},props:{item:Object},methods:{_ok:function(){this._verification()&&this._submit()},_verification:function(){return!!this.token||(this.$message.warning(""+a.default.$t("Please generate token")),!1)},_submit:function(){var t=this,e={expireTime:(0,o.default)(this.expireTime).format("YYYY-MM-DD HH:mm:ss"),userId:this.userId,token:this.token};this.item&&(e.id=this.item.id),this.$refs.popover.spinnerLoading=!0,this.store.dispatch("user/"+(this.item?"updateToken":"createToken"),e).then((function(e){t.$emit("onUpdate"),t.$message.success(e.msg),t.$refs.popover.spinnerLoading=!1})).catch((function(e){t.$message.error(e.msg||""),t.$refs.popover.spinnerLoading=!1}))},_generateToken:function(){var t=this;this.tokenLoading=!0,this.store.dispatch("user/generateToken",{userId:this.userId,expireTime:this.expireTime}).then((function(e){setTimeout((function(){t.tokenLoading=!1,t.token=e}),1200)})).catch((function(e){t.token="",t.$message.error(e.msg||""),t.tokenLoading=!1}))},_onChange:function(){this.token=""},close:function(){this.$emit("close")}},watch:{},created:function(){var t=this,e=function(e){t.item?(t.expireTime=t.item.expireTime,t.userId=t.item.userId,t.token=t.item.token):t.userId=e};this.auth?this.store.dispatch("security/getUsersAll").then((function(n){t.userIdList=i.default.map(n,(function(t){return i.default.pick(t,["id","userName"])})),e(t.userIdList[0].id)})):e(this.store.state.user.userInfo.id)},mounted:function(){},components:{mPopover:u.default,mListBoxF:c.default}}},1632:function(t,e,n){},1898:function(t,e,n){"use strict";n.r(e);var i=n(1944),o=n(1455);for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);var s=n(30),r=Object(s.a)(o.default,i.a,i.b,!1,null,null,null);e.default=r.exports},1899:function(t,e,n){"use strict";n.r(e);var i=n(1945),o=n(1457);for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n(1900);var s=n(30),r=Object(s.a)(o.default,i.a,i.b,!1,null,null,null);e.default=r.exports},1900:function(t,e,n){"use strict";n(1632)},1937:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("m-list-construction",{attrs:{title:t.$t("Token manage")}},[n("template",{slot:"conditions"},[n("m-conditions",{on:{"on-conditions":t._onConditions}},[n("template",{slot:"button-group"},[n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t._create("")}}},[t._v(t._s(t.$t("Create token")))]),t._v(" "),t.createTokenDialog?n("el-dialog",{attrs:{title:t.item?t.$t("Edit token"):t.$t("Create token"),visible:t.createTokenDialog,width:"auto"},on:{"update:visible":function(e){t.createTokenDialog=e}}},[n("m-create-token",{attrs:{item:t.item},on:{onUpdate:t.onUpdate,close:t.close}})],1):t._e()],1)],2)],1),t._v(" "),n("template",{slot:"content"},[t.tokenList.length||t.total>0?[n("m-list",{attrs:{"token-list":t.tokenList,"page-no":t.searchParams.pageNo,"page-size":t.searchParams.pageSize},on:{"on-update":t._onUpdate,"on-edit":t._onEdit}}),t._v(" "),n("div",{staticClass:"page-box"},[n("el-pagination",{attrs:{background:"","page-size":t.searchParams.pageSize,"current-page":t.searchParams.pageNo,"page-sizes":[10,30,50],layout:"sizes, prev, pager, next, jumper",total:t.total},on:{"current-change":t._page,"size-change":t._pageSize,"update:currentPage":function(e){return t.$set(t.searchParams,"pageNo",e)},"update:current-page":function(e){return t.$set(t.searchParams,"pageNo",e)}}})],1)]:t._e(),t._v(" "),!t.tokenList.length&&t.total<=0?[n("m-no-data")]:t._e(),t._v(" "),n("m-spin",{attrs:{"is-spin":t.isLoading,"is-left":t.isLeft}})],2)],2)},o=[]},1944:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"list-model"},[n("div",{staticClass:"table-box"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,size:"mini"}},[n("el-table-column",{attrs:{type:"index",label:t.$t("#"),width:"50"}}),t._v(" "),n("el-table-column",{attrs:{prop:"userName",label:t.$t("User")}}),t._v(" "),n("el-table-column",{attrs:{prop:"token",label:"Token",width:"300"}}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("Expiration time"),"min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t._f("formatDate")(e.row.expireTime)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("Create Time"),"min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t._f("formatDate")(e.row.createTime)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("Update Time"),"min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t._f("formatDate")(e.row.updateTime)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("Operation"),width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{attrs:{content:t.$t("Edit"),placement:"top",enterable:!1}},[n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit-outline",circle:""},on:{click:function(n){return t._edit(e.row)}}})],1),t._v(" "),n("el-tooltip",{attrs:{content:t.$t("Delete"),placement:"top",enterable:!1}},[n("el-popconfirm",{attrs:{confirmButtonText:t.$t("Confirm"),cancelButtonText:t.$t("Cancel"),icon:"el-icon-info",iconColor:"red",title:t.$t("Delete?")},on:{onConfirm:function(n){return t._delete(e.row,e.row.id)}}},[n("el-button",{attrs:{slot:"reference",type:"danger",size:"mini",icon:"el-icon-delete",circle:""},slot:"reference"})],1)],1)]}}])})],1)],1)])},o=[]},1945:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("m-popover",{ref:"popover",attrs:{"ok-text":t.item?t.$t("Edit"):t.$t("Submit")},on:{ok:t._ok,close:t.close}},[n("template",{slot:"content"},[n("div",{staticClass:"create-token-model"},[n("m-list-box-f",[n("template",{slot:"name"},[n("strong",[t._v("*")]),t._v(t._s(t.$t("Expiration time")))]),t._v(" "),n("template",{slot:"content"},[n("el-date-picker",{attrs:{type:"datetime","picker-options":t.pickerOptions,format:"yyyy-MM-dd HH:mm:ss",size:"small"},on:{"on-change":t._onChange},model:{value:t.expireTime,callback:function(e){t.expireTime=e},expression:"expireTime"}})],1)],2),t._v(" "),t.auth?n("m-list-box-f",[n("template",{slot:"name"},[n("strong",[t._v("*")]),t._v(t._s(t.$t("User")))]),t._v(" "),n("template",{slot:"content"},[n("el-select",{attrs:{size:"small"},on:{change:t._onChange},model:{value:t.userId,callback:function(e){t.userId=e},expression:"userId"}},t._l(t.userIdList,(function(t){return n("el-option",{key:t.id,attrs:{value:t.id,label:t.userName}})})),1)],1)],2):t._e(),t._v(" "),n("m-list-box-f",[n("template",{slot:"name"},[t._v("Token")]),t._v(" "),n("template",{slot:"content"},[n("el-input",{staticStyle:{width:"306px"},attrs:{readonly:"",type:"input",size:"small",placeholder:t.$t("Please enter token")},model:{value:t.token,callback:function(e){t.token=e},expression:"token"}}),t._v(" "),n("el-button",{attrs:{size:"small",loading:t.tokenLoading},on:{click:t._generateToken}},[t._v(t._s(t.$t("Generate token")))])],1)],2)],1)])],2)},o=[]}}]);